<!DOCTYPE html><html style="--vsc-domain: &quot;rakko.tools&quot;;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link rel="stylesheet" type="text/css" id="u0" href="https://rakko.tools/tools/129/lib/tinymce/skins/ui/oxide/content.min.css"><link rel="stylesheet" type="text/css" id="u1" href="https://rakko.tools/tools/129/lib/tinymce/skins/content/default/content.min.css"></head><body id="tinymce" class="mce-content-body " data-id="content" contenteditable="true" spellcheck="false"><p>&lt;!DOCTYPE html&gt;<br>&lt;html lang="ja"&gt;<br>&lt;head&gt;<br>&nbsp; &nbsp; &lt;meta charset="UTF-8"&gt;<br>&nbsp; &nbsp; &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;<br>&nbsp; &nbsp; &lt;title&gt;YouTube Privacy Player&lt;/title&gt;<br>&nbsp; &nbsp; &lt;style&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; body {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-family: sans-serif;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; line-height: 1.6;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 20px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background-color: #f4f4f4;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color: #333;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; .container {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; max-width: 800px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin: 0 auto;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 20px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background-color: #fff;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; border: 1px solid #ccc;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; border-radius: 8px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; box-shadow: 0 2px 5px rgba(0,0,0,0.1);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; h1 {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; text-align: center;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin-bottom: 20px;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; h2 {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; border-bottom: 2px solid #007bff;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding-bottom: 5px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin-top: 30px;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; .input-group {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; display: flex;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; gap: 10px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; margin-bottom: 20px;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; .input-group input {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flex-grow: 1;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 10px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-size: 16px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; border: 1px solid #ccc;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; border-radius: 4px;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; .input-group button {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 10px 20px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-size: 16px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cursor: pointer;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color: white;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; border: none;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; border-radius: 4px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transition: background-color 0.3s;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background-color: #c4302b; /* YouTube Red */<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; .input-group button:hover {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background-color: #a02622;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; #search-container { margin-bottom: 20px; }<br>&nbsp; &nbsp; &nbsp; &nbsp; .video-wrapper {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; position: relative;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; width: 100%;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding-top: 56.25%;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background-color: #000;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; border-radius: 8px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; overflow: hidden;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; .video-wrapper iframe {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; #errorMessage { color: red; margin-top: 10px; text-align: center; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; /* ===== 履歴機能用のスタイル ===== */<br>&nbsp; &nbsp; &nbsp; &nbsp; .history-header {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; display: flex;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; justify-content: space-between;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; align-items: center;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; #clearHistoryButton {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 5px 10px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; font-size: 12px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; background-color: #6c757d;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cursor: pointer;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; border-radius: 4px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color: white;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; border: none;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; #clearHistoryButton:hover { background-color: #5a6268; }<br>&nbsp; &nbsp; &nbsp; &nbsp; #historyList {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; list-style: none;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 0;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; max-height: 200px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; overflow-y: auto;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; border: 1px solid #eee;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; border-radius: 4px;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; #historyList li {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 10px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; border-bottom: 1px solid #eee;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cursor: pointer;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; transition: background-color 0.2s;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; #historyList li:last-child { border-bottom: none; }<br>&nbsp; &nbsp; &nbsp; &nbsp; #historyList li:hover { background-color: #f0f0f0; }<br>&nbsp; &nbsp; &nbsp; &nbsp; #historyList .no-history {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; padding: 10px;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; color: #888;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; text-align: center;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &lt;/style&gt;<br>&lt;/head&gt;<br>&lt;body&gt;</p><p>&nbsp; &nbsp; &lt;div class="container"&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;h1&gt;YouTube Privacy Player&lt;/h1&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;h2&gt;1. 動画を検索する&lt;/h2&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;div id="search-container"&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;script async src="https://cse.google.com/cse.js?cx=d02f1e46ace6b4d88"&gt;&lt;/script&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;div class="gcse-search"&gt;&lt;/div&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;h2&gt;2. URLを貼り付けて再生&lt;/h2&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;div class="input-group"&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;input type="text" id="youtubeUrl" placeholder="ここにYouTubeのURLを貼り付け"&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;button id="playButton"&gt;表示&lt;/button&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;div class="video-wrapper" id="videoContainer"&gt;&lt;/div&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;p id="errorMessage"&gt;&lt;/p&gt;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- ===== ここからが履歴機能の表示エリア ===== --&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;div class="history-header"&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;h2&gt;3. 視聴履歴&lt;/h2&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;button id="clearHistoryButton"&gt;履歴を消去&lt;/button&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/div&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;ul id="historyList"&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- 履歴はここに動的に追加されます --&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/ul&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;!-- ===== 履歴機能ここまで ===== --&gt;<br>&nbsp; &nbsp; &lt;/div&gt;</p><p>&nbsp; &nbsp; &lt;script&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; const urlInput = document.getElementById('youtubeUrl');<br>&nbsp; &nbsp; &nbsp; &nbsp; const playButton = document.getElementById('playButton');<br>&nbsp; &nbsp; &nbsp; &nbsp; const videoContainer = document.getElementById('videoContainer');<br>&nbsp; &nbsp; &nbsp; &nbsp; const errorMessage = document.getElementById('errorMessage');<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; // ===== 履歴機能用の要素を取得 =====<br>&nbsp; &nbsp; &nbsp; &nbsp; const historyList = document.getElementById('historyList');<br>&nbsp; &nbsp; &nbsp; &nbsp; const clearHistoryButton = document.getElementById('clearHistoryButton');<br>&nbsp; &nbsp; &nbsp; &nbsp; const HISTORY_KEY = 'youtubePlayerHistory'; // localStorageのキー<br>&nbsp; &nbsp; &nbsp; &nbsp; const MAX_HISTORY_ITEMS = 20; // 履歴の最大保存数</p><p>&nbsp; &nbsp; &nbsp; &nbsp; function extractVideoId(url) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!url) return null;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const regex = /(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:watch\?v=|embed\/|v\/|shorts\/)|youtu\.be\/)([\w-]{11})/;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const match = url.match(regex);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return match ? match[1] : null;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; // `async` をつけて非同期処理に対応<br>&nbsp; &nbsp; &nbsp; &nbsp; async function playVideo() {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let urlToProcess = urlInput.value.trim();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; errorMessage.textContent = '';</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (urlToProcess.includes('google.com/url?')) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const urlObject = new URL(urlToProcess);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const realYoutubeUrl = urlObject.searchParams.get('q');<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (realYoutubeUrl) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; urlToProcess = realYoutubeUrl;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (e) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.error("URL解析エラー:", e);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const videoId = extractVideoId(urlToProcess);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (videoId) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const embedUrl = `https://www.youtube-nocookie.com/embed/${videoId}?autoplay=1&amp;rel=0`;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; videoContainer.innerHTML = `&lt;iframe src="${embedUrl}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;`;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // ===== 動画のタイトルを取得して履歴に追加 =====<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // YouTubeのoEmbed APIを使って動画情報を取得（APIキー不要）<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const response = await fetch(`https://www.youtube.com/oembed?url=http://www.youtube.com/watch?v=${videoId}&amp;format=json`);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (response.ok) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const data = await response.json();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; addToHistory(videoId, data.title);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (error) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; console.error('動画情報の取得に失敗:', error);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // タイトルが取れなくてもIDだけで履歴に追加する<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; addToHistory(videoId, `動画ID: ${videoId}`);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; errorMessage.textContent = '有効なYouTubeのURLを入力してください。';<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; videoContainer.innerHTML = '';<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // ===== 履歴関連の関数 =====</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // 履歴をlocalStorageから読み込む<br>&nbsp; &nbsp; &nbsp; &nbsp; function getHistory() {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const historyJson = localStorage.getItem(HISTORY_KEY);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return historyJson ? JSON.parse(historyJson) : [];<br>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // 履歴をlocalStorageに保存する<br>&nbsp; &nbsp; &nbsp; &nbsp; function saveHistory(history) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; localStorage.setItem(HISTORY_KEY, JSON.stringify(history));<br>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // 履歴に動画を追加する<br>&nbsp; &nbsp; &nbsp; &nbsp; function addToHistory(videoId, videoTitle) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; let history = getHistory();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 既に同じIDの動画があれば一旦削除（リストの先頭に移動させるため）<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; history = history.filter(item =&gt; item.id !== videoId);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 新しい履歴を先頭に追加<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; history.unshift({ id: videoId, title: videoTitle });<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // 履歴が最大数を超えていたら古いものから削除<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (history.length &gt; MAX_HISTORY_ITEMS) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; history.pop();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; saveHistory(history);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; renderHistory(); // 履歴の表示を更新<br>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // 履歴をHTMLとして描画する<br>&nbsp; &nbsp; &nbsp; &nbsp; function renderHistory() {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const history = getHistory();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; historyList.innerHTML = ''; // 一旦リストを空にする<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (history.length === 0) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; historyList.innerHTML = '&lt;li class="no-history"&gt;視聴履歴はありません。&lt;/li&gt;';<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; history.forEach(item =&gt; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const li = document.createElement('li');<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; li.textContent = item.title;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; li.dataset.videoId = item.id; // videoIdをdata属性として保持<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; historyList.appendChild(li);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; });<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // ===== イベントリスナーの設定 =====<br>&nbsp; &nbsp; &nbsp; &nbsp; playButton.addEventListener('click', playVideo);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; urlInput.addEventListener('keypress', event =&gt; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (event.key === 'Enter') {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; event.preventDefault();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playVideo();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; });</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // 履歴リストの項目がクリックされたときの処理<br>&nbsp; &nbsp; &nbsp; &nbsp; historyList.addEventListener('click', event =&gt; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (event.target.tagName === 'LI' &amp;&amp; event.target.dataset.videoId) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const videoId = event.target.dataset.videoId;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; urlInput.value = `https://www.youtube.com/watch?v=${videoId}`;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playVideo();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; window.scrollTo(0, 0); // ページ上部にスクロール<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; });<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; // 「履歴を消去」ボタンがクリックされたときの処理<br>&nbsp; &nbsp; &nbsp; &nbsp; clearHistoryButton.addEventListener('click', () =&gt; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (confirm('本当に視聴履歴をすべて消去しますか？')) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; localStorage.removeItem(HISTORY_KEY);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; renderHistory(); // 表示を更新<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; });</p><p>&nbsp; &nbsp; &nbsp; &nbsp; // ページ読み込み時に実行<br>&nbsp; &nbsp; &nbsp; &nbsp; document.addEventListener('DOMContentLoaded', () =&gt; {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; renderHistory(); // 履歴を表示<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const params = new URLSearchParams(window.location.search);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; const youtubeUrlFromParam = params.get('url');<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (youtubeUrlFromParam) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; urlInput.value = decodeURIComponent(youtubeUrlFromParam);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; playVideo();<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; });<br>&nbsp; &nbsp; &lt;/script&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;</p></body></html>